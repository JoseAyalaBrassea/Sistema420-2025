generator client {
  provider = "prisma-client-js"
}


datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model part_test_legacy {
  pn                          String   @db.VarChar(15)
  application                 String   @db.VarChar(20)
  revision                    Int
  revision_datetime           DateTime @db.DateTime(0)
  fixture                     String?  @db.VarChar(20)
  air_fixture                 String?  @db.VarChar(20)
  nominal_voltage             Int      @db.TinyInt
  tube_qty_limit              Int?     @db.TinyInt
  is_shield_installed         Int      @db.TinyInt
  is_diode_installed          Int      @db.TinyInt
  contact_1_type              String   @db.Char(1)
  contact_2_type              String?  @db.Char(1)
  contact_3_type              String?  @db.Char(1)
  contact_4_type              String?  @db.Char(1)
  atm                         Int      @db.TinyInt
  atm_max_time                Decimal? @db.Decimal(10, 4)
  atm_start_frequency         Decimal? @db.Decimal(10, 4)
  atm_end_frequency           Decimal? @db.Decimal(10, 4)
  atm_step_frequency          Decimal  @db.Decimal(10, 4)
  atm_coil_voltage            Decimal? @db.Decimal(10, 4)
  buz                         Int
  buz_cycles                  Int?
  buz_frequency               Int?
  crs                         Int      @db.TinyInt
  crs_max_resistance          Decimal? @db.Decimal(10, 4)
  crs_min_resistance          Decimal? @db.Decimal(10, 4)
  crs_nom_resistance          Decimal? @db.Decimal(10, 4)
  crs_tolerance               Decimal? @db.Decimal(10, 4)
  dio                         Int      @db.TinyInt
  dcp                         Int      @db.TinyInt
  dcp_max_peak_to_peak        Decimal? @db.Decimal(10, 4)
  dcr                         Int      @db.TinyInt
  dcr_max_peak                Decimal? @db.Decimal(10, 4)
  dcr_coil_voltage            Decimal? @db.Decimal(10, 4)
  dcr_start_frequency         Int?
  dcr_end_frequency           Int?
  dcr_step_frequency          Int?
  dcr_start_measurment_window Decimal? @db.Decimal(10, 4)
  dcr_window_width            Decimal? @db.Decimal(10, 4)
  dcr_sweeps                  Int?
  fbo                         Int      @db.TinyInt
  fbo_coil_voltage            Decimal? @db.Decimal(10, 4)
  fbo_percent_overdrive       Decimal? @db.Decimal(10, 4)
  fbo_delay                   Decimal? @db.Decimal(9, 6)
  irs                         Int      @db.TinyInt
  irs_range                   Decimal? @db.Decimal(10, 4)
  irs_coil_voltage            Decimal? @db.Decimal(10, 4)
  irs_delay                   Decimal? @db.Decimal(9, 6)
  kel                         Int      @db.TinyInt
  ocu                         Int      @db.TinyInt
  ocu_max_current             Decimal? @db.Decimal(10, 4)
  ocu_min_current             Decimal? @db.Decimal(10, 4)
  otm                         Int      @db.TinyInt
  otm_max_time                Decimal? @db.Decimal(10, 4)
  otm_start_frequency         Decimal? @db.Decimal(10, 4)
  otm_end_frequency           Decimal? @db.Decimal(10, 4)
  otm_step_frequency          Decimal? @db.Decimal(10, 4)
  otm_coil_voltage            Decimal? @db.Decimal(10, 4)
  ovd                         Int      @db.TinyInt
  ovd_min_differential        Decimal? @db.Decimal(10, 4)
  ovd_max_differential        Decimal? @db.Decimal(10, 4)
  ovr                         Int      @db.TinyInt
  ovr_max_percentage          Decimal? @db.Decimal(10, 4)
  ovr_min_percentage          Decimal? @db.Decimal(10, 4)
  ovt                         String   @db.VarChar(45)
  ovt_max_voltage             Decimal? @db.Decimal(10, 4)
  ovt_min_voltage             Decimal? @db.Decimal(10, 4)
  ovt_delay                   Decimal? @db.Decimal(9, 6)
  rcu                         Int      @db.TinyInt
  rcu_max_current             Decimal? @db.Decimal(10, 4)
  rcu_min_current             Decimal? @db.Decimal(10, 4)
  rtm                         Int      @db.TinyInt
  rtm_max_time                Decimal? @db.Decimal(10, 4)
  rtm_start_frequency         Decimal? @db.Decimal(10, 4)
  rtm_end_frequency           Decimal? @db.Decimal(10, 4)
  rtm_step_frequency          Decimal? @db.Decimal(10, 4)
  rtm_coil_voltage            Decimal? @db.Decimal(10, 4)
  rvt                         Int      @db.TinyInt
  rvt_max_voltage             Decimal? @db.Decimal(10, 4)
  rvt_min_voltage             Decimal? @db.Decimal(10, 4)
  rvt_delay                   Decimal  @db.Decimal(9, 6)
  scr                         Int      @db.TinyInt
  scr_max_resistance          Decimal? @db.Decimal(10, 4)
  scr_min_resistance          Decimal? @db.Decimal(10, 4)
  scr_delay                   Decimal? @db.Decimal(9, 6)
  scs                         Int      @db.TinyInt
  scs_max_delta               Decimal? @db.Decimal(10, 4)
  scs_cycles                  Int?
  scs_warm_up                 Int?
  scs_delay                   Decimal? @db.Decimal(9, 6)
  sho                         Int      @db.TinyInt
  sho_threshold_resistance    Decimal? @db.Decimal(10, 4)
  ttm                         Int      @db.TinyInt
  ttm_min_time                Decimal? @db.Decimal(10, 4)

  @@id([pn, application])
}

model part_test_specifications {
  pn                          String       @db.VarChar(15)
  application                 String       @db.VarChar(20)
  revision                    Int
  revision_datetime           DateTime     @db.DateTime(0)
  fixture                     String?      @db.VarChar(20)
  air_fixture                 String?      @db.VarChar(20)
  nominal_voltage             Decimal      @db.Decimal(5, 3)
  sort_file                   String?      @db.VarChar(10)
  graph_freq             Decimal?     @db.Decimal(5, 3)
  tube_qty_limit              Int?         @db.TinyInt
  is_shield_installed         Int          @db.TinyInt
  is_diode_installed          Int          @db.TinyInt
  contact_1_type              String       @db.Char(1)
  contact_2_type              String?      @db.Char(1)
  contact_3_type              String?      @db.Char(1)
  contact_4_type              String?      @db.Char(1)
  atm                         Int          @db.TinyInt
  atm_max_time                Decimal?     @db.Decimal(10, 4)
  buz                         Int
  buz_cycles                  Int?
  buz_frequency               Int?
  crs                         Int          @db.TinyInt
  crs_nom_resistance          Decimal?     @db.Decimal(10, 4)
  crs_tolerance               Decimal?     @db.Decimal(10, 4)
  dio                         Int          @db.TinyInt
  dcp                         Int          @db.TinyInt
  dcp_max_peak_to_peak        Decimal?     @db.Decimal(10, 4)
  dcr                         Int          @db.TinyInt
  dcr_max_peak                Decimal?     @db.Decimal(10, 4)
  dcr_start_measurment_window Decimal?     @db.Decimal(10, 4)
  dcr_window_width            Decimal?     @db.Decimal(10, 4)
  dcr_sweeps                  Int?
  fbo                         Int          @db.TinyInt
  fbo_percent_overdrive       Decimal?     @db.Decimal(10, 4)
  fbo_delay                   Decimal?     @db.Decimal(9, 6)
  irs                         Int          @db.TinyInt
  irs_range                   Decimal?     @db.Decimal(10, 4)
  irs_test_voltage            Decimal?     @db.Decimal(10, 4)
  irs_delay                   Decimal?     @db.Decimal(9, 6)
  kel                         Int          @db.TinyInt
  ocu                         Int          @db.TinyInt
  ocu_max_current             Decimal?     @db.Decimal(10, 4)
  ocu_min_current             Decimal?     @db.Decimal(10, 4)
  otm                         Int          @db.TinyInt
  otm_max_time                Decimal?     @db.Decimal(10, 4)
  vtd                         Int          @db.TinyInt
  vtd_min_differential        Decimal?     @db.Decimal(10, 4)
  vtd_max_differential        Decimal?     @db.Decimal(10, 4)
  vtr                         Int          @db.TinyInt
  vtr_max_percentage          Decimal?     @db.Decimal(10, 4)
  vtr_min_percentage          Decimal?     @db.Decimal(10, 4)
  ovt                         Int          @db.TinyInt
  ovt_max_voltage             Decimal?     @db.Decimal(10, 4)
  ovt_min_voltage             Decimal?     @db.Decimal(10, 4)
  ovt_delay                   Decimal?     @db.Decimal(9, 6)
  rcu                         Int          @db.TinyInt
  rcu_max_current             Decimal?     @db.Decimal(10, 4)
  rcu_min_current             Decimal?     @db.Decimal(10, 4)
  rtm                         Int          @db.TinyInt
  rtm_max_time                Decimal?     @db.Decimal(10, 4)
  rvt                         Int          @db.TinyInt
  rvt_max_voltage             Decimal?     @db.Decimal(10, 4)
  rvt_min_voltage             Decimal?     @db.Decimal(10, 4)
  rvt_delay                   Decimal?     @db.Decimal(9, 6)
  scr                         Int          @db.TinyInt
  scr_max_resistance          Decimal?     @db.Decimal(10, 4)
  scr_min_resistance          Decimal?     @db.Decimal(10, 4)
  scr_delay                   Decimal?     @db.Decimal(9, 6)
  scs                         Int          @db.TinyInt
  scs_max_delta               Decimal?     @db.Decimal(10, 4)
  scs_cycles                  Int?
  scs_warm_up                 Int?
  scs_delay                   Decimal?     @db.Decimal(9, 6)
  sho                         Int          @db.TinyInt
  sho_threshold_resistance    Decimal?     @db.Decimal(10, 4)
  ttm                         Int          @db.TinyInt
  ttm_min_time                Decimal?     @db.Decimal(10, 4)
  sort_limits                 sort_limits? @relation(fields: [sort_file], references: [file_name], onDelete: NoAction, onUpdate: NoAction, map: "Sort_file")
  test                        test[]

  @@id([pn, application])
  @@index([sort_file], map: "Sort_file_idx")
}

model sort_limits {
  file_name                String                     @id @db.VarChar(10)
  low_limit                Decimal?                   @db.Decimal(6, 3)
  hi_limit                 Decimal?                   @db.Decimal(6, 3)
  part_test_specifications part_test_specifications[]
}

model sys_config {
  variable String    @id @db.VarChar(128)
  value    String?   @db.VarChar(128)
  set_time DateTime? @default(now()) @db.Timestamp(0)
  set_by   String?   @db.VarChar(128)
}

model test {
  id                                Int                                 @id @default(autoincrement())
  pn                                String                              @db.VarChar(15)
  application                       String                              @db.VarChar(20)
  user                              Int
  is_standard_test                  Int                                 @default(1) @db.TinyInt
  type_of_test                      String                              @db.VarChar(20)
  revision                          Int
  job_order                         String?                             @db.VarChar(20)
  plt                               String?                             @db.VarChar(20)
  datecode                          String                              @db.Char(4)
  lot_number                        String?                             @db.VarChar(20)
  start_datetime                    DateTime                            @db.DateTime(0)
  end_datetime                      DateTime                            @db.DateTime(0)
  relays_tested                     Int
  relays_passed_420                 Int?
  relays_failed_420                 Int
  yield                             Decimal                             @db.Decimal(6, 3)
  relays_failed_non_420             Int
  total_quantity                    Int
  reject_quantity                   Int?
  final_yield                       Decimal?                            @db.Decimal(6, 3)
  issue_quantity                    Int
  issue_yield                       Decimal                             @db.Decimal(6, 3)
  part_test_specifications          part_test_specifications            @relation(fields: [pn, application], references: [pn, application], onDelete: NoAction, onUpdate: NoAction, map: "part_test_id_application")
  user_test_userTouser              user                                @relation("test_userTouser", fields: [user], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "user")
  test_fails_non_420                test_fails_non_420?
  test_result                       test_result[]
  test_result_insulation_resistance test_result_insulation_resistance[]
  elapsed_time                      DateTime?                             @db.Time(0)
  test_time                         DateTime?                             @db.Time(0)
  idle_time                         DateTime?                             @db.Time(0)

  @@index([pn, application], map: "part_test_id_idx")
  @@index([user], map: "user_idx")
}

model test_fails_non_420 {
  id                            Int  @id @default(0)
  total_failed_non_420          Int  @default(0)
  failed_mechanical_crack       Int  @default(0)
  failed_mechanical_potting     Int  @default(0)
  failed_mechanical_plating     Int  @default(0)
  failed_mechanical_stamping    Int  @default(0)
  failed_mechanical_trimming    Int  @default(0)
  failed_mechanical_dimensional Int  @default(0)
  failed_mechanical_other       Int  @default(0)
  failed_electrical_thermal     Int  @default(0)
  failed_electrical_magnet      Int  @default(0)
  failed_electrical_resonent    Int  @default(0)
  failed_electrical_breakdown   Int  @default(0)
  failed_electrical_timing      Int  @default(0)
  failed_electrical_other       Int  @default(0)
  test                          test @relation(fields: [id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Test ID")
}

model test_result {
  test_id   Int
  dut_no    Int      @db.SmallInt
  test_type String   @db.Char(50)
  switch    Int      @db.TinyInt
  result    String   @db.VarChar(20)
  value     Decimal? @db.Decimal(21, 4)
  test      test     @relation(fields: [test_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "test_test_result_id")

  @@id([test_id, dut_no, test_type, switch])
  @@index([test_id], map: "test_test_result_id_idx")
}

model test_result_insulation_resistance {
  test_id        Int
  dut_no         Int      @db.SmallInt
  coil_value     Decimal? @db.Decimal(17, 0)
  shield_value   Decimal? @db.Decimal(17, 0)
  switch1t_value Decimal? @db.Decimal(17, 0)
  switch1b_value Decimal? @db.Decimal(17, 0)
  switch2t_value Decimal? @db.Decimal(17, 0)
  switch2b_value Decimal? @db.Decimal(17, 0)
  switch3t_value Decimal? @db.Decimal(17, 0)
  switch3b_value Decimal? @db.Decimal(17, 0)
  switch4t_value Decimal? @db.Decimal(17, 0)
  switch4b_value Decimal? @db.Decimal(17, 0)
  test           test     @relation(fields: [test_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Test_ID")

  @@id([test_id, dut_no])
  @@index([test_id], map: "test_test_result_id_idx")
}

model user {
  id                   Int        @id @default(autoincrement())
  username             String     @unique(map: "username_UNIQUE") @db.VarChar(20)
  first_name           String     @db.VarChar(20)
  last_name            String     @db.VarChar(20)
  user_type            String     @db.VarChar(20)
  password             String     @db.VarChar(20)
  test_test_userTouser test[]     @relation("test_userTouser")
  user_log             user_log[]
}

model user_log {
  id       Int      @id @default(autoincrement())
  id_user  Int
  datetime DateTime @db.DateTime(0)
  user     user     @relation(fields: [id_user], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Id User")

  @@index([id_user], map: "Id User_idx")
}
